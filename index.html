<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
  <meta name="NCAA Bracket" content="content">
  <link rel="stylesheet" href="bracket.css" type="text/css">
  <title> 2012 NCAA Men's Basketball Tournament </title>
</head>
<body class="bracket standings light-blue">
<div id="content-wrapper">
  <div id="table">
     <table class="gridtable">

<!-- Table Dates -->
     <tr>
        <th class="round_1 current"> 1st ROUND </th>
        <th class="round_2 "> 2nd ROUND </th>
        <th class="round_3"> SWEET 16 </th>
        <th class="round_4"> ELITE EIGHT </th>
        <th class="round5"> FINAL FOUR </th>
        <th class="round_6"> CHAMPION </th>
        <th class="round_5"> FINAL FOUR </th>
        <th class="round_4"> ELITE EIGHT </th>
        <th class="round_3"> SWEET 16 </th>
        <th class="round_2"> 2nd ROUND </th>
        <th class="round_1 current"> 1st ROUND </th>
      </tr>
      <tr>
        <td class="current"> March 18-19 </td>
        <td> March 20-21 </td>
        <td> March 25-26 </td>
        <td> March 27-28 </td>
        <td> April 3 </td>
        <td> April 5 </td>
        <td> April 3 </td>
        <td> March 27-28 </td>
        <td> March 25-26 </td>
        <td> March 20-21 </td>
        <td class="current"> March 18-19 </td>
      </tr>
    </table>
  </div>

<!-- Bracket -->
  <div id="bracket">
    <div id="round1" class="round">
      <h3>
        Round One (2012 NCAA Men's Basketball Tournament)
      </h3>

      <div class="region region1">
        <h4 class="region1 first_region">
          MIDWEST
        </h4>
        <div id="match17" class="match m1"></div>
        <div id="match18" class="match m2"></div>
        <div id="match19" class="match m3"></div>
        <div id="match20" class="match m4"></div>
        <div id="match21" class="match m5"></div>
        <div id="match22" class="match m6"></div>
        <div id="match23" class="match m7"></div>
        <div id="match24" class="match m8"></div>
      </div>
      <div class="region region2">
        <h4 class="region2 first_region">
          West
        </h4>
        <div id="match25" class="match m1"></div>
        <div id="match26" class="match m2"></div>
        <div id="match27" class="match m3"></div>
        <div id="match28" class="match m4"></div>
        <div id="match29" class="match m5"></div>
        <div id="match30" class="match m6"></div>
        <div id="match31" class="match m7"></div>
        <div id="match32" class="match m8"></div>
      </div>
      <div class="region region3">
        <h4 class="region3 first_region">
          EAST
        </h4>
        <div id="match1" class="match m1"></div>
        <div id="match2" class="match m2"></div>
        <div id="match3" class="match m3"></div>
        <div id="match4" class="match m4"></div>
        <div id="match5" class="match m5"></div>
        <div id="match6" class="match m6"></div>
        <div id="match7" class="match m7"></div>
        <div id="match8" class="match m8"></div>
      </div>
      <div class="region region4">
        <h4 class="region4 first_region">
          South
        </h4>
        <div id="match9" class="match m1"></div>
        <div id="match10" class="match m2"></div>
        <div id="match11" class="match m3"></div>
        <div id="match12" class="match m4"></div>
        <div id="match13" class="match m5"></div>
        <div id="match14" class="match m6"></div>
        <div id="match15" class="match m7"></div>
        <div id="match16" class="match m8"></div>
      </div>
    </div>
    <div id="round2" class="round">
      <h3>
        Round Two (2010 NCAA Men's Basketball Tournament)
      </h3>
      <div class="region region1">
        <h4 class="region1">
          MIDWEST
        </h4>
        <div id="match41" class="match m1"></div>
        <div id="match42" class="match m2"></div>
        <div id="match43" class="match m3"></div>
        <div id="match44" class="match m4"></div>
      </div>
      <div class="region region2">
        <h4 class="region2">
          WEST
        </h4>
        <div id="match45" class="match m1"></div>
        <div id="match46" class="match m2"></div>
        <div id="match47" class="match m3"></div>
        <div id="match48" class="match m4"></div>
      </div>
      <div class="region region3">
        <h4 class="region3">
          East
        </h4>
        <div id="match33" class="match m1"></div>
        <div id="match34" class="match m2"></div>
        <div id="match35" class="match m3"></div>
        <div id="match36" class="match m4"></div>
      </div>
      <div class="region region4">
        <h4 class="region4">
          South
        </h4>
        <div id="match37" class="match m1"></div>
        <div id="match38" class="match m2"></div>
        <div id="match39" class="match m3"></div>
        <div id="match40" class="match m4"></div>
      </div>
    </div>
    <div id="round3" class="round">
      <h3>
        Round Three (2010 NCAA Men's Basketball Tournament)
      </h3>
      <div class="region region1">
        <h4 class="region1">
          Midwest
        </h4>
        <div id="match53" class="match m1"></div>
        <div id="match54" class="match m2"></div>
      </div>
      <div class="region region2">
        <h4 class="region2">
          West
        </h4>
        <div id="match55" class="match m1"></div>
        <div id="match56" class="match m2"></div>
      </div>
      <div class="region region3">
        <h4 class="region3">
          East
        </h4>
        <div id="match49" class="match m1"></div>
        <div id="match50" class="match m2"></div>
      </div>
      <div class="region region4">
        <h4 class="region4">
          South
        </h4>
        <div id="match51" class="match m1"></div>
        <div id="match52" class="match m2"></div>
      </div>
    </div>
    <div id="round4" class="round">
      <h3>
        Round Four (2010 NCAA Men's Basketball Tournament)
      </h3>
      <div class="region region1">
        <h4 class="region1">
          Midwest
        </h4>
        <div id="match59" class="match m1"></div>
      </div>
      <div class="region region2">
        <h4 class="region2">
          West
        </h4>
        <div id="match60" class="match m1"></div>
      </div>
      <div class="region region3">
        <h4 class="region3">
          East
        </h4>
        <div id="match57" class="match m1"></div>
      </div>
      <div class="region region4">
        <h4 class="region4">
          South
        </h4>
        <div id="match58" class="match m1"></div>
      </div>
    </div>
    <div id="round5" class="round">
      <h3>
        Round Five (2010 NCAA Men's Basketball Tournament)
      </h3>
      <div class="region">
        <div id="match61" class="match m1"></div>
        <div id="match62" class="match m2"></div>
      </div>
    </div>
    <div id="round6" class="round">
      <h3>
        Round Six (2010 NCAA Men's Basketball Tournament)
      </h3>
      <div class="region">
        <div id="match63" class="match m1"></div>
      </div>
    </div>
  </div>
</div>

<script>

var teams = [
  // East
  [1, "Pitt", 16, "E Tenn St"],
  [8, "Okla St", 9, "Tennessee"],
  [5, "FSU", 12, "Wisconsin"],
  [4, "Xavier", 13, "Portland St"],
  [6, "UCLA", 11, "VCU"],
  [3, "Villanova", 14, "American"],
  [7, "Texas", 10, "Minnesota"],
  [2, "Duke", 15, "Binghamton"],
  // South
  [1, "UNC", 16, "Radford"], //  <---------------
  [8, "s-Okla St", 9, "s-Tennessee"],
  [5, "s-FSU", 12, "s-Wisconsin"],
  [4, "s-Xavier", 13, "s-Portland St"],
  [6, "s-UCLA", 11, "s-VCU"],
  [3, "s-Villanova", 14, "s-American"],
  [7, "s-Texas", 10, "s-Minnesota"],
  [2, "s-Duke", 15, "s-Binghamton"],
  // Midwest
  [1, "m-Pitt", 16, "m-E Tenn St"],
  [8, "m-Okla St", 9, "m-Tennessee"],
  [5, "m-FSU", 12, "m-Wisconsin"],
  [4, "m-Xavier", 13, "m-Portland St"],
  [6, "m-UCLA", 11, "m-VCU"],
  [3, "m-Villanova", 14, "m-American"],
  [7, "m-Texas", 10, "m-Minnesota"],
  [2, "m-Duke", 15, "m-Binghamton"],
  // West
  [1, "w-Pitt", 16, "w-E Tenn St"],
  [8, "w-Okla St", 9, "w-Tennessee"],
  [5, "w-FSU", 12, "w-Wisconsin"],
  [4, "w-Xavier", 13, "w-Portland St"],
  [6, "w-UCLA", 11, "w-VCU"],
  [3, "w-Villanova", 14, "w-American"],
  [7, "w-Texas", 10, "w-Minnesota"],
  [2, "w-Duke", 15, "w-Binghamton"]
]

// This is hard coded to only work for a tournament with 64 main teams (the first round is handled separately)
// First put the teams in their starting postions
for(i=0; i<64; i++) {
    var matchId = "match" + (i + 1)
    if (document.getElementById(matchId)) {
        document.getElementById(matchId).innerHTML = '<p class="slot slot1" ></p><p class="slot slot2" ></p>'
    }}
for (i=0; i<32; i++) {
    var matchId = "match" + (i + 1)
    if (document.getElementById(matchId)) {
        document.getElementById(matchId).getElementsByClassName("slot slot1")[0].innerHTML = '<span class="seed">' + teams[i][0] + '</span><span class="team"> ' + teams[i][1] + ' </span>'
        document.getElementById(matchId).getElementsByClassName("slot slot2")[0].innerHTML = '<span class="seed">' + teams[i][2] + '</span><span class="team"> ' + teams[i][3] + ' </span>'
    } else {
        console.debug("missing: " + matchId)
    }
}

var timeout = 1000
// window.setTimeout(function(){ advanceWinner(0,  32, true) },timeout)
// window.setTimeout(function(){ advanceWinner(48, 56, true) },timeout)
// window.setTimeout(function(){ advanceWinner(60, 62, true) },timeout)
// window.setTimeout(function(){ advanceWinner(62, 63, false) },timeout)

// window.setTimeout(function(){ advanceWinner(0,  32, true) },timeout)
// window.setTimeout(function(){ advanceWinner(32, 48, true) },timeout*2)
// window.setTimeout(function(){ advanceWinner(48, 56, true) },timeout*3)
// window.setTimeout(function(){ advanceWinner(56, 60, true) },timeout*4)
// window.setTimeout(function(){ advanceWinner(60, 62, true) },timeout*5)
// window.setTimeout(function(){ advanceWinner(62, 63, false) },timeout*6)

advanceWinner(0,  32, true)
advanceWinner(32, 48, true)
advanceWinner(48, 56, true)
advanceWinner(56, 60, true)
advanceWinner(60, 62, true)
advanceWinner(62, 63, false)
// Now find the winners
function advanceWinner(start, stop, doAdvance) {
    for (i=start; i<stop; i++) {
        var matchId = "match" + (i + 1)
        var seeds = getSeeds(matchId)
        var winner = playThem(seeds[0], seeds[1])
        var winnerName = ""
        var loserName = ""
        var winnerSeed = 0
        var loserSeed = 0
        if (winner == 1) {
            winnerName = document.getElementById(matchId).getElementsByClassName("slot slot1")[0].getElementsByClassName("team")[0].textContent
            loserName = document.getElementById(matchId).getElementsByClassName("slot slot2")[0].getElementsByClassName("team")[0].textContent
            winnerSeed = seeds[0]
            loserSeed = seeds[1]
            // mark the winner and loser
            document.getElementById(matchId).getElementsByClassName("slot slot1")[0].innerHTML = '<span class="winner"><span class="seed">' + winnerSeed + '</span><span class="team"> ' + winnerName + ' </span></span>'
            document.getElementById(matchId).getElementsByClassName("slot slot2")[0].innerHTML = '<span class="loser"><span class="seed">' + loserSeed + '</span><span class="team"> ' + loserName + ' </span></span>'
        } else {
            winnerName = document.getElementById(matchId).getElementsByClassName("slot slot2")[0].getElementsByClassName("team")[0].textContent
            loserName = document.getElementById(matchId).getElementsByClassName("slot slot1")[0].getElementsByClassName("team")[0].textContent
            winnerSeed = seeds[1]
            loserSeed = seeds[0]
            document.getElementById(matchId).getElementsByClassName("slot slot1")[0].innerHTML = '<span class="loser"><span class="seed">' + loserSeed + '</span><span class="team"> ' + loserName + ' </span></span>'
            document.getElementById(matchId).getElementsByClassName("slot slot2")[0].innerHTML = '<span class="winner"><span class="seed">' + winnerSeed + '</span><span class="team"> ' + winnerName + ' </span></span>'
        }

        if (doAdvance) {
            var newMatchId = "match" + Math.trunc((65 + i + 1)/2)
            // odd ids (id = i + 1) go into slot1 in the new, even in slot2
            if (Math.trunc(i + 1) % 2 == 1) {
                document.getElementById(newMatchId).getElementsByClassName("slot slot1")[0].innerHTML = '<span class="seed">' + winnerSeed + '</span><span class="team"> ' + winnerName + ' </span>'
            } else {
                document.getElementById(newMatchId).getElementsByClassName("slot slot2")[0].innerHTML = '<span class="seed">' + winnerSeed + '</span><span class="team"> ' + winnerName + ' </span>'
            }
        }
    }
}

function playThem(seed1, seed2) {
    // Simplifies logic if seed1 is always the lower (better) seed.
    var switched = false
    if (seed1 > seed2) {
        var temp = seed1
        seed1 = seed2
        seed2 = temp
        switched = true
    }
    var rand = Math.random()
    // totally bogus function to let seeding influence the outcome
    // f = ax^b + c
    // f(0) = 0.5 -- even odds
    // f(15) = 0.99 -- seed1 99% win rate, 1 seed vs 16
    var x = seed2 - seed1
    var b = 1.5
    var a = 0.49/Math.pow(15, b)
    var factor = a * Math.pow(x, b) + 0.5

    // console.log("rand: " + precisionRound(rand, 2) + " factor: " + precisionRound(factor,2))

    if (rand > factor) {
        return switched ? 1 : 2
    }
    return switched ? 2 : 1
}

function getSeeds(matchId) {
    var seed1String = document.getElementById(matchId).getElementsByClassName("slot slot1")[0].getElementsByClassName("seed")[0].textContent
    var seed2String = document.getElementById(matchId).getElementsByClassName("slot slot2")[0].getElementsByClassName("seed")[0].textContent
    return [parseInt(seed1String, 10), parseInt(seed2String, 10)]
}

function precisionRound(number, precision) {
  var factor = Math.pow(10, precision);
  return Math.round(number * factor) / factor;
}
// for (i=1; i<67; i++) {
//   if (document.getElementById("match" + i)) {
//     // document.getElementById("match" + i).getElementsByClassName("slot slot1")[0].innerHTML = "match" + i + " id" + (((65-i)*2))
//     // document.getElementById("match" + i).getElementsByClassName("slot slot2")[0].innerHTML = "match" + i + " id" + (((65-i)*2) - 1)
//
//     document.getElementById("match" + i).getElementsByClassName("slot slot1")[0].innerHTML =   document.getElementById("match" + i).getElementsByClassName("slot slot1")[0].getElementsByClassName("team")[0].textContent
//     document.getElementById("match" + i).getElementsByClassName("slot slot2")[0].innerHTML = document.getElementById("match" + i).getElementsByClassName("slot slot2")[0].getElementsByClassName("seed")[0].textContent
//   } else {
//     console.debug("missing: " + i)
//   }
// }
// --------------------------------

// document.getElementById("id6").innerHTML += "Testing_6"
// document.getElementById("id2").innerHTML = '<span class="winner"><span class="seed">0</span> One more time </span>';
// document.getElementById("id1").class = 'winner'
</script>
</body>
</html>
